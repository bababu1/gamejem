# ──────────────────────────────────────────────────────────────────────────────
#                                  [면접의 신]
#                    심층 분기 및 히든 이벤트 포함 확장판 (패치 버전)
# ──────────────────────────────────────────────────────────────────────────────

# ──────────────────────────────────────────────────
# 1)  변수 · 플래그 초기화 ─ init 블록
# ──────────────────────────────────────────────────
init:
    default trust      = 0   # 조직 적합·신뢰
    default pro        = 0   # 전문성·실적
    default creative   = 0   # 창의성·아이디어
    default stress     = 0   # 스트레스 지수(히든)

    default pressure_event_triggered = False
    default tech_event_triggered     = False
    default tea_event_triggered      = False

# ──────────────────────────────────────────────────
# 2)  캐릭터 정의
# ──────────────────────────────────────────────────

define iv   = Character("면접관",      color="#c8c8ff")
define sen  = Character("선임 개발자",  color="#90ee90")
define tea  = Character("팀 동료",      color="#add8e6")
# 내레이션 – 글상자 그대로 사용
define narr = Character(None, what_prefix="【 ", what_suffix=" 】")

# ──────────────────────────────────────────────────
# 3)  이미지 정의 (누락 보강 포함)
# ──────────────────────────────────────────────────
image bg office        = "images/bg_office.jpg"
image bg lounge        = "images/bg_lounge.jpg"

image iv_happy         = "images/interviewer_happy.png"
image iv_neutral       = "images/interviewer_neutral.png"   # ← 기존 누락분 보강
image iv_serious       = "images/interviewer_serious.png"
image iv_thinking      = "images/interviewer_thinking.png"
image iv_surprised     = "images/interviewer_surprised.png"

image sen_neutral      = "images/senior_neutral.png"
image tea_happy        = "images/teammate_happy.png"

# ──────────────────────────────────────────────────
# 4)  메인 스토리 시작
# ──────────────────────────────────────────────────

label start:
    scene bg office
    show iv_neutral
    iv "반갑습니다. 저희 회사에 지원해주셔서 감사합니다."
    iv "저는 오늘 면접을 진행할 OOO입니다."
    iv "많이 긴장되시겠지만, 편안한 분위기에서 본인의 역량을 마음껏 보여주시길 바랍니다."
    iv "그럼, 면접을 시작하겠습니다. 먼저 자기소개 부탁드립니다."
    jump q1

# ──────────────────────────────────────────────────
# 5)  1차 질문 (자기소개)
# ──────────────────────────────────────────────────

label q1:
    menu:
        "끊임없이 배우고 동료와 함께 성장하는, 열정 넘치는 지원자 OOO입니다!":
            iv "성장과 열정, 좋은 키워드네요."
            $ trust += 1
            $ creative += 1
            jump q2_enthusiastic

        "구체적인 데이터와 성과로 증명하는, 결과 중심의 지원자 OOO입니다.":
            iv "성과 중심의 접근, 좋습니다. 기대가 되는군요."
            $ pro += 2
            jump q2_result

        "어... 안녕하십니까. 이번 개발 직무에 지원하게 된 OOO입니다. 잘 부탁드립니다.":
            iv "(고개를 끄덕인다) 네, 반갑습니다."
            $ trust -= 1
            $ stress += 1
            jump q2_nervous

# ──────────────────────────────────────────────────
#    2차 질문 (열정 루트) – 이하 원본 흐름 유지
# ──────────────────────────────────────────────────

label q2_enthusiastic:
    show iv_happy
    iv "패기가 느껴져서 좋네요. 그렇다면 입사 후에 어떤 역할로 팀에 기여하고 싶으신가요?"
    menu:
        "다양한 아이디어를 내고 새로운 시도를 이끄는 '아이디어 뱅크'가 되고 싶습니다.":
            $ creative += 2
            $ pro += 1
            iv "팀에 새로운 활력을 불어넣어 주실 수 있겠군요."
            jump q3_enth_creative

        "동료들의 의견을 경청하고 시너지를 만들어 팀의 사기를 북돋우는 '분위기 메이커'가 되겠습니다.":
            $ trust += 2
            $ creative += 1
            iv "소통과 협업을 중요하게 생각하시는군요."
            jump q3_enth_team

        "맡은 분야에서 최고의 기술 전문가가 되어 기술적 난제를 해결하는 '해결사'가 되고 싶습니다.":
            $ pro += 2
            iv "기술에 대한 자부심이 느껴집니다."
            jump q3_enth_tech

# ──────────────────────────────────────────────────
#    2차 질문 (결과 지향 루트) – '%' → '%%' 패치
# ──────────────────────────────────────────────────

label q2_result:
    show iv_thinking
    iv "결과를 중요시하는군요. 좋습니다. 본인이 주도했던 프로젝트 중 가장 자랑스러운 성과가 있다면 구체적인 수치를 포함해서 말씀해주시겠어요?"
    menu:
        "기존의 수동 프로세스를 자동화하는 스크립트를 개발하여 팀의 월간 업무 시간을 50%% 단축시킨 경험이 있습니다.":
            $ pro += 2
            $ trust += 1
            iv "업무 효율 개선에 직접적으로 기여하셨군요. 인상적입니다."
            jump q3_res_tech

        "사용자 피드백 500건을 분석하고 A/B 테스트를 통해 핵심 서비스의 이탈률을 20%% 낮춘 경험이 있습니다.":
            $ pro += 2
            $ creative += 1
            iv "데이터 기반의 의사결정 능력이 뛰어나시네요."
            jump q3_res_creative

        "팀원 간의 갈등으로 중단 위기였던 프로젝트에서, 양측의 의견을 중재하고 역할 분담을 명확히 하여 데드라인 내에 성공적으로 마감한 경험이 있습니다.":
            $ trust += 2
            $ pro += 1
            iv "위기관리 능력과 협업 능력이 돋보이는군요."
            jump q3_res_team

# ──────────────────────────────────────────────────
#  ◆ 이후 3차·4차·5차·히든 이벤트·엔딩 라벨들은
#    당신이 올려주신 원본 코드와 동일 구조입니다.
#    변경 필요 부분은:
#       • 이미지 이름 누락이 없도록 확인
#       • 메뉴 문자열 중 '%' → '%%' 로 이스케이프
# ──────────────────────────────────────────────────

# ── 2차 질문 (긴장 루트) ─────────────────────────────
label q2_nervous:
    show iv_serious
    iv "많이 긴장하신 것 같네요. 괜찮습니다. 편하게 하세요."
    iv "업무를 하다 보면 예상치 못한 스트레스 상황이 발생하기도 합니다. 평소 스트레스는 어떻게 관리하는 편이신가요?"
    $ stress += 1
    menu:
        "관련 기술 서적이나 강의를 찾아보며 부족한 점을 채우려고 노력합니다. 지식을 쌓는 과정에서 자신감을 얻고 스트레스도 자연스럽게 해소됩니다.":
            $ pro += 2
            $ trust += 1
            $ stress -= 1
            iv "자기계발을 통해 스트레스를 극복하는군요. 긍정적인 방법이네요."
            jump q3_nerv_tech

        "코딩이나 글쓰기 같은 창작 활동에 몰두합니다. 무언가를 만들면서 스트레스를 생산적인 에너지로 전환하려고 합니다.":
            $ creative += 2
            $ trust += 1
            $ stress -= 1
            iv "창의적인 활동으로 해소하신다니, 독특하고 좋은 방법입니다."
            jump q3_nerv_creative

        "주로 산책을 하거나 가까운 친구들과 대화하며 마인드 컨트롤을 합니다. 문제를 객관적으로 보려고 노력합니다.":
            $ trust += 2
            $ stress -= 1
            iv "안정적인 방법이군요. 자기 객관화는 중요한 덕목이죠."
            jump q3_nerv_team

# ──────────────────────────────────────────────────────────────────────────────
#
#                                  3차 질문 분기
#
# ──────────────────────────────────────────────────────────────────────────────

# ── 3차 질문 (열정 루트 -> 창의성) ──────────────────
label q3_enth_creative:
    show iv_neutral
    iv "아이디어 뱅크라... 좋습니다. 그럼 돌발 질문을 하나 드려보죠."
    iv "지금 당장, 저희 서비스의 핵심 기능을 딱 하나만 바꿀 수 있다면, 어떤 것을 어떻게 바꾸고 싶으신가요? 그리고 그 이유는 무엇인가요?"
    menu:
        "수익 모델과 직결되는 핵심 기능은 안정성을 위해 유지하고, 사용자 편의성을 높이는 부가 기능 개선에 집중하겠습니다. 예를 들어...":
            $ pro += 1
            $ trust += 1
            iv "안정성을 중시하는군요. 현실적인 접근입니다."
            jump q4_common_risk
        "최신 AI 기술을 접목하여, 사용자의 행동 패턴을 분석하고 다음 행동을 예측하는 '개인화 추천 기능'을 고도화하고 싶습니다.":
            $ creative += 2
            $ pro += 2
            iv "구체적인 기술까지 언급하시다니, 고민의 깊이가 느껴집니다."
            jump q4_common_conflict
        "경쟁사에는 없는, 완전히 새로운 개념의 '커뮤니티 기능'을 추가하여 사용자의 체류 시간을 늘리고 락인 효과를 만들고 싶습니다.":
            $ creative += 3
            $ trust -= 1 # 너무 급진적
            iv "굉장히 과감한 아이디어네요. 리스크가 크지 않을까요?"
            jump q4_creative_new_feature_followup

# ── 3차 질문 (열정 루트 -> 팀워크) ──────────────────
label q3_enth_team:
    show iv_neutral
    iv "팀의 시너지를 중요하게 생각하시는군요. 좋습니다."
    iv "만약, 팀 전체가 동의한 목표가 자신의 가치관이나 의견과 정면으로 충돌한다면 어떻게 하시겠습니까?"
    menu:
        "우선 팀의 목표를 따르겠습니다. 조직의 목표 달성이 개인의 의견보다 우선되어야 한다고 생각합니다. 다만, 제 의견은 기록으로 남겨 추후 회고 시 논의해볼 수 있도록 하겠습니다.":
            $ trust += 2
            $ pro += 1
            iv "조직을 먼저 생각하는 모습이 인상적이네요."
            jump q4_common_risk
        "팀의 목표에 공식적으로는 따르되, 비공식적인 자리에서 동료나 리더를 설득하여 제 의견의 타당성을 증명하려고 노력할 것 같습니다.":
            $ pro += 1
            $ trust -= 1
            $ stress += 1
            iv "비공식적인 설득이요? 그게 자칫 팀워크를 해칠 수도 있지 않을까요?"
            jump q4_pressure_followup
        "팀원들과 충분한 대화의 시간을 요청하겠습니다. 제 의견을 데이터와 함께 논리적으로 설명하고, 더 나은 제3의 대안을 함께 찾는 데 집중하겠습니다.":
            $ trust += 2
            $ creative += 1
            $ pro += 1
            iv "갈등을 성장의 기회로 삼으려는 태도가 좋네요."
            jump q4_common_conflict

# ── 3차 질문 (열정 루트 -> 기술) ──────────────────
label q3_enth_tech:
    show iv_neutral
    iv "기술 전문가, 좋습니다. 빠르게 변화하는 기술의 홍수 속에서 뒤처지지 않기 위해 어떤 노력을 하고 계신가요?"
    menu:
        "매일 1시간 이상 기술 블로그나 해외 아티클을 읽고, 중요 내용은 노션에 정리하여 팀 스터디 때 공유합니다.":
            $ pro += 2
            $ trust += 1
            iv "꾸준함과 공유 정신, 둘 다 훌륭합니다."
            jump q4_common_conflict
        "주말마다 사이드 프로젝트를 진행하며 새로운 기술 스택(e.g., GraphQL, Docker)을 직접 적용해보고 경험을 쌓습니다.":
            $ pro += 3
            $ creative += 1
            iv "실전 경험을 중요하게 생각하시는군요. 포트폴리오가 있다면 나중에 보고 싶네요."
            jump q4_common_risk
        "기술의 깊이가 더 중요하다고 생각합니다. 회사에서 사용하는 주력 기술 스택의 내부 동작 원리를 파악하고 공식 문서를 정독하는 데 시간을 투자합니다.":
            $ pro += 2
            iv "기본기를 탄탄히 다지는 스타일이시군요."
            # 히든 이벤트 체크: 전문성이 매우 높으면 기술 심층 질문으로 넘어간다.
            if pro >= 5 and not tech_event_triggered:
                jump special_event_technical_test
            else:
                jump q4_common_risk

# ── (이하 결과 지향, 긴장 루트의 3차 질문들도 위와 같이 세분화하여 구성) ────────
label q3_res_tech:
    show iv_neutral
    iv "업무 효율화 경험이 인상 깊군요. 그렇다면, 본인이 도입한 기술이나 프로세스에 대해 팀원들이 반발하거나 적응을 어려워했던 적은 없었나요? 있었다면 어떻게 해결했습니까?"
    menu:
        "설명회를 열고, 매뉴얼을 작성해 배포하며 지속적으로 사용을 독려했습니다. 결국 시간이 해결해 주었습니다.":
            $pro += 1
            $trust += 1
            jump q4_common_conflict
        "반발이 가장 심했던 팀원 한 명을 집중적으로 설득하고, 그가 다른 팀원들을 이끌도록 만들었습니다. 일종의 '키맨' 전략이었습니다.":
            $pro += 2
            $creative += 1
            $trust -= 1
            jump q4_common_conflict
        "초기에는 거부감이 있었지만, 새로운 방식이 기존보다 얼마나 효율적인지를 직접 데이터로 증명해주자 다들 수긍했습니다.":
            $pro += 3
            jump q4_common_risk


label q3_res_creative:
    show iv_neutral
    iv "데이터 기반의 문제 해결 능력이 좋으시네요. 하지만 데이터가 모든 것을 말해주지는 않죠."
    iv "만약, 데이터 분석 결과와 당신의 직관이 완전히 반대되는 결론을 내린다면, 어느 쪽을 따르시겠습니까?"
    menu:
        "당연히 데이터를 따르겠습니다. 직관은 주관적이며, 편향에 빠질 수 있기 때문입니다.":
            $pro += 2
            jump q4_common_risk
        "결정을 보류하고, 제 직관이 맞다는 것을 증명할 다른 데이터를 찾아보거나 새로운 가설을 세워 추가 실험을 진행하겠습니다.":
            $pro += 1
            $creative += 2
            jump q4_common_conflict
        "소규모 그룹을 대상으로 제 직관에 따른 아이디어를 빠르게 프로토타이핑하여 테스트해 보겠습니다. 고객의 실제 반응을 보는 것이 가장 확실하니까요.":
            $creative += 2
            $pro += 1
            jump q4_common_risk


label q3_res_team:
    show iv_neutral
    iv "갈등 중재 경험이라, 쉽지 않은 일이죠. 리더십이 있으시군요."
    iv "그렇다면 당신이 팀장이 되었는데, 팀원 중 한 명이 다른 모든 팀원과 마찰을 일으키는 '트러블 메이커'라면 어떻게 하시겠습니까?"
    menu:
        "객관적인 성과 평가 시스템을 도입하여, 감정적인 부분이 아닌 결과로만 평가받는 환경을 만들겠습니다.":
            $pro += 2
            $trust -=1
            jump q4_common_risk
        "그 팀원과 1대1 면담을 주기적으로 진행하여, 문제의 원인을 파악하고 개선의 기회를 주겠습니다. 하지만 3개월의 시간을 주고도 변하지 않는다면, 최종적인 결단을 내리겠습니다.":
            $trust += 2
            $pro += 1
            jump q4_common_conflict
        "팀 전체 워크숍을 열어 서로에 대해 이해하는 시간을 갖게 하고, 그 팀원의 장점을 부각시켜 줄 수 있는 역할을 맡겨 팀에 융화되도록 돕겠습니다.":
            $trust += 2
            $creative += 1
            jump q4_common_team_building


label q3_nerv_tech:
    show iv_happy
    iv "자기계발을 통해 스트레스를 푸는 건전한 방법이네요. 보기 좋습니다."
    iv "그렇다면, 지금까지 공부했던 기술 중에서 우리 회사 서비스에 가장 크게 기여할 수 있다고 생각하는 기술은 무엇이고, 그 이유는 무엇인가요?"
    menu:
        "MSA(Microservice Architecture)입니다. 현재 모놀리식 구조의 서비스를 점진적으로 MSA로 전환한다면, 서비스의 확장성과 안정성을 크게 높일 수 있을 것입니다.":
            $pro += 3
            jump q4_common_risk
        "TDD(Test-Driven Development) 방법론입니다. 체계적인 테스트 코드 작성을 통해 버그를 줄이고, 코드 퀄리티를 높여 장기적인 유지보수 비용을 절감할 수 있습니다.":
            $pro += 2
            $trust += 1
            jump q4_common_conflict
        "React Native나 Flutter 같은 크로스플랫폼 기술입니다. 적은 리소스로 iOS와 Android 앱을 동시에 개발하여 빠르게 시장에 진입할 수 있습니다.":
            $pro += 2
            $creative += 1
            jump q4_common_risk


label q3_nerv_creative:
    show iv_happy
    iv "창작 활동으로 스트레스를 푸신다니, 멋지네요. 그런 분들이 보통 문제 해결 능력도 뛰어나더군요."
    iv "만약, 회사에서 아무도 시도해보지 않은, 완전히 새로운 프로젝트를 당신에게 맡긴다면 가장 먼저 무엇부터 하시겠습니까?"
    menu:
        "프로젝트의 목표와 핵심 성공 지표(KPI)를 명확히 정의하는 것부터 시작하겠습니다. 방향이 명확해야 흔들리지 않으니까요.":
            $pro += 2
            jump q4_common_risk
        "프로젝트와 관련된 최고의 전문가들을 찾아가 조언을 구하고, 작은 스터디 그룹을 만들어 함께 아이디어를 구체화해나가겠습니다.":
            $trust += 2
            $creative += 1
            jump q4_common_conflict
        "일단 빠르게 시장에 던져볼 수 있는 최소 기능 제품(MVP)을 만들어 고객의 반응을 살피겠습니다. 시장이 답을 줄 거라 믿습니다.":
            $pro += 1
            $creative += 2
            jump q4_common_risk


label q3_nerv_team:
    show iv_neutral
    iv "안정적인 스트레스 관리법이군요. 좋습니다."
    # 히든 이벤트 체크: 신뢰도가 높고 긴장 상태에서 시작했다면, 면접관이 편안한 분위기를 유도
    if trust >= 3 and stress > 0 and not tea_event_triggered:
        jump special_event_teatime

    iv "협업에 대해 질문드리겠습니다. 당신이 생각하는 '좋은 동료'란 어떤 사람인가요? 그리고 본인은 다른 사람들에게 어떤 동료라고 생각하십니까?"
    menu:
        "'좋은 동료'란 자신의 업무에 책임을 다하는 사람입니다. 저 또한 제가 맡은 일은 반드시 시간 내에 최고 퀄리티로 완수하여 동료들에게 신뢰를 줍니다.":
            $pro += 2
            jump q4_common_risk
        "'좋은 동료'란 긍정적인 에너지를 주는 사람입니다. 저 또한 항상 웃는 얼굴로 먼저 다가가고, 동료의 성과를 진심으로 축하해주는 편입니다.":
            $trust += 2
            jump q4_common_team_building
        "'좋은 동료'란 새로운 지식이나 노하우를 기꺼이 공유하는 사람입니다. 저 또한 제가 알게 된 유용한 정보가 있으면 팀에 적극적으로 공유하려고 노력합니다.":
            $trust += 1
            $pro += 1
            $creative += 1
            jump q4_common_conflict


# ──────────────────────────────────────────────────────────────────────────────
#
#                                  4차 질문 분기 및 추격 질문
#
# ──────────────────────────────────────────────────────────────────────────────

# ── 4차 추격 질문 (창의성 루트 - 과감한 제안) ────────
label q4_creative_new_feature_followup:
    show iv_serious
    iv "리스크가 크다고 말씀드렸는데, 그럼에도 불구하고 그 아이디어를 밀어붙여야 하는 이유를 30초 안에 저에게 설명해서 설득해보시겠어요?"
    $ stress += 1
    menu:
        "시장을 선도하기 위해서는 때로는 과감한 베팅이 필요합니다. 실패의 리스크는 작게 시작하여 테스트하며 관리하고, 성공했을 때의 기대 이익이 훨씬 크기 때문에 도전할 가치가 있습니다.":
            $ pro += 2
            $ creative += 1
            $ stress -= 1
            show iv_thinking
            iv "논리적인 답변이네요. 리스크 관리 방안까지 생각했다니, 좋습니다."
            jump q5_common
        "지금의 안정적인 서비스는 결국 사용자들이 질리게 될 것입니다. 새로운 자극을 주지 않으면 결국 경쟁사에 밀리게 될 것입니다. 생존을 위해선 변화해야 합니다.":
            $ creative += 1
            $ trust -= 1
            show iv_thinking
            iv "다소 감정적인 호소처럼 들리지만... 위기 의식은 확실히 느껴지네요."
            jump q5_common
        "(당황한다) 어... 그건... 혁신적인 서비스가 될 것이라고... 확신하기 때문입니다.":
            $ pro -= 1
            $ trust -= 1
            $ stress += 1
            show iv_serious
            iv "구체적인 근거가 부족하군요. 알겠습니다."
            jump q5_common

# ── 4차 추격 질문 (팀워크 루트 - 압박) ──────────────
label q4_pressure_followup:
    show iv_serious
    iv "팀워크를 해칠 수 있는 방법을 택하겠다고요? 만약 당신의 비공식적인 설득 활동이 팀 내에서 파벌을 만들고 프로젝트를 더 큰 위기에 빠뜨린다면 어떻게 책임지실 겁니까?"
    $ stress += 2
    # 히든 이벤트 체크: 스트레스가 극에 달하면 압박 면접 이벤트 발생
    if stress >= 4 and not pressure_event_triggered:
        jump special_event_pressure

    menu:
        "그렇게 되기 전에 제 활동을 즉시 중단하고, 팀의 결정에 전적으로 따르겠습니다. 저의 섣부른 판단이었음을 인정하고 공식적으로 사과하겠습니다.":
            $ trust += 2
            $ pro -= 1
            $ stress -= 1
            iv "자신의 실수를 빠르게 인정하는군요. 좋습니다."
            jump q5_common
        "그건 최악의 시나리오일 뿐입니다. 저는 제 설득 능력에 자신이 있습니다. 그렇게 되기 전에 팀원 대다수는 제 의견에 동의하게 될 것입니다.":
            $ pro += 1
            $ trust -= 2
            iv "근거 없는 자신감은 위험할 수 있습니다."
            jump q5_common
        "모든 책임은 제가 지겠습니다. 프로젝트 실패 시, 그에 상응하는 페널티를 받겠습니다.":
            $ trust += 1
            $ pro -= 1
            iv "책임감은 높이 사지만, 프로젝트는 실패하면 안 되겠죠."
            jump q5_common


# ── 4차 공통 질문들 ─────────────────────────────────
# (이전 분기에서 이곳으로 점프)

label q4_common_conflict:
    show iv_thinking
    iv "다음 질문입니다. 당신의 가장 친한 동료가 회사의 중요한 규정을 어기는 것을 목격했습니다. 사소하지만 명백한 위반입니다. 어떻게 하시겠습니까?"
    menu:
        "직접적으로 말하기는 어려우니, 익명으로 제보할 수 있는 시스템이 있다면 그를 통해 알리겠습니다.":
            $trust -= 1
            $pro += 1
            jump q5_common
        "동료에게 직접 찾아가, 규정 위반의 위험성에 대해 설명하고 스스로 바로잡을 기회를 주겠습니다.":
            $trust += 2
            jump q5_common
        "팀장님께만 조용히 찾아가 사실을 알리고, 어떻게 대처하는 것이 좋을지 조언을 구하겠습니다.":
            $trust += 1
            $pro += 1
            jump q5_common
        "친한 동료와의 관계를 망치고 싶지 않습니다. 사소한 문제라면 모른 척 할 것 같습니다.":
            $trust -= 2
            jump q5_common


label q4_common_risk:
    show iv_serious
    iv "알겠습니다. 만약, 당신이 담당하던 프로젝트가 출시 하루 전에 치명적인 버그가 발견되어 실패할 위기에 처했다면 어떻게 하시겠습니까?"
    menu:
        "즉시 출시를 연기하고, 밤을 새워서라도 원인을 찾아 해결하겠습니다. 고객과의 약속을 어기더라도, 불완전한 제품을 내놓을 수는 없습니다.":
            $pro += 2
            $trust += 1
            jump q5_common
        "일단 예정대로 출시하고, 긴급 공지를 통해 사용자들에게 상황을 알리고 양해를 구하겠습니다. 그리고 최대한 빠른 시일 내에 핫픽스 패치를 배포하겠습니다.":
            $pro -= 1
            $creative += 1
            jump q5_common
        "팀원들을 모아놓고, 현재 상황에서 우리가 할 수 있는 최선과 최악의 시나리오를 공유하며 해결책을 함께 논의하겠습니다. 리더 혼자 결정할 문제가 아니라고 생각합니다.":
            $trust += 2
            $creative += 1
            jump q5_common


label q4_common_team_building:
    show iv_happy
    iv "팀워크를 만들어가는 능력이 있으시군요."
    iv "당신이 팀의 리더가 되었습니다. 성과가 조금 부족하지만 매우 성실하고 팀워크가 좋은 팀원과, 성과는 뛰어나지만 다소 이기적이고 독단적인 팀원 중 한 명만 승진시켜야 한다면 누구를 선택하시겠습니까?"
    menu:
        "성과가 뛰어난 팀원을 승진시키겠습니다. 회사는 이익을 내야 하는 곳이고, 성과가 그 기준이 되어야 합니다.":
            $pro += 2
            $trust -=1
            jump q5_common
        "성실하고 팀워크가 좋은 팀원을 승진시키겠습니다. 좋은 팀워크가 장기적으로는 더 높은 성과를 가져올 것이라고 믿습니다.":
            $trust += 2
            jump q5_common
        "승진 결정을 보류하고, 두 팀원에게 각각 부족한 부분(팀워크, 성과)에 대한 명확한 개선 목표를 주고, 3개월 뒤에 다시 평가하여 결정하겠습니다.":
            $pro += 1
            $trust += 1
            $creative += 1
            jump q5_common

# ──────────────────────────────────────────────────────────────────────────────
#
#                                  히든 이벤트
#
# ──────────────────────────────────────────────────────────────────────────────

# ── 히든 이벤트 1 (압박 면접) ───────────────────────
label special_event_pressure:
    $ pressure_event_triggered = True
    $ stress += 1
    show iv_serious
    iv "..."
    iv "답변이 계속 바뀌는군요. 아까는 결과를 중시한다고 하셨는데, 지금은 과정을 얘기하고..."
    iv "자신이 어떤 사람인지 스스로도 잘 모르는 것 아닙니까?"
    iv "우리 회사는 자신의 강점과 약점을 명확히 알고, 일관성 있게 행동하는 사람을 원합니다."
    narr "압박 면접이 시작되었다. 면접관의 날카로운 눈빛이 심장을 꿰뚫는 것 같다."
    menu:
        "(침착하게) 면접관님의 지적에 대해 다시 생각해보았습니다. 제가 생각하는 핵심 가치는 '성장'이며, 상황에 따라 최적의 방법을 선택하는 과정에서 다르게 보일 수 있다고 생각합니다. 일관성이 부족해 보였다면 그 점은 개선하겠습니다.":
            $stress -= 2
            $trust += 2
            $pro += 1
            show iv_thinking
            iv "압박 속에서도 평정심을 잃지 않는군요. 알겠습니다."
            jump q5_common
        "(감정이 격해지며) 아닙니다! 저는 일관성 있는 사람입니다. 면접이라는 특수한 상황 때문에 긴장해서 그런 것 뿐입니다.":
            $stress += 1
            $trust -= 2
            show iv_serious
            iv "알겠습니다. 다음 질문으로 넘어가죠."
            jump q5_common
        "(아무 말도 못하고 우물쭈물한다) ...죄송합니다.":
            $stress += 2
            $pro -= 1
            $trust -= 1
            show iv_serious
            iv "..."
            jump q5_common


# ── 히든 이벤트 2 (기술 심층 면접) ───────────────────
label special_event_technical_test:
    $ tech_event_triggered = True
    show iv_neutral
    iv "기술에 대한 이해도가 깊으신 것 같으니, 다른 분을 잠시 모시겠습니다."
    narr "면접관이 잠시 자리를 비우더니, 편안한 복장의 다른 사람과 함께 들어왔다."
    hide iv_neutral
    show sen_neutral
    sen "안녕하세요, 저는 개발팀의 선임 개발자 OOO입니다. 기술적인 부분에 대해 몇 가지만 더 깊게 여쭤봐도 될까요?"
    sen "최근에 해결했던 가장 복잡했던 기술적 문제는 무엇이었고, 어떤 과정을 통해 해결하셨나요? 코드를 본다고 생각하고 최대한 자세하게 설명해주세요."
    menu:
        "레거시 시스템에서 발생한 N+1 쿼리 문제였습니다. 문제의 원인이 되는 ORM 로직을 찾아내고, Fetch Join을 적용하여 쿼리 실행 횟수를 획기적으로 줄였습니다. 또한 배치 사이즈를 조절하여... (구체적으로 설명한다)":
            $pro += 3
            sen "오, Fetch Join과 배치 최적화까지... 원리를 정확히 알고 계시네요. 좋습니다."
            jump q5_common_after_tech
        "동시성 문제였습니다. 여러 스레드가 공유 자원에 동시에 접근하면서 데이터 불일치가 발생했는데, synchronized 키워드를 사용하여 임계 영역을 설정하고... (원론적으로 설명한다)":
            $pro += 1
            show sen_neutral
            sen "네, 기본적인 해결 방법이군요. 알겠습니다."
            jump q5_common_after_tech
        "어... 가장 복잡했던 문제는... 지금 바로 생각나지는 않지만, 보통 구글링과 스택 오버플로우를 통해 해결하는 편입니다.":
            $pro -= 2
            show sen_neutral
            sen "알겠습니다."
            jump q5_common_after_tech


# ── 히든 이벤트 3 (티타임) ─────────────────────────
label special_event_teatime:
    $ tea_event_triggered = True
    $ stress = 0 # 스트레스 완전 해소
    show iv_happy
    iv "면접 분위기가 너무 딱딱했죠? 잠시 쉬어갈 겸, 다른 곳으로 자리를 옮길까요?"
    scene bg lounge
    iv "마침 저희 팀원 한 명이 근처에 있네요. 잠시 합석해도 괜찮을까요?"
    narr "면접관이 손짓하자, 밝은 인상의 직원이 음료를 들고 다가왔다."
    show tea_happy
    tea "안녕하세요! 면접 보시는 중이었군요. 저는 OOO팀의 OOO입니다."
    tea "와, 저희 팀에 지원하셨다니! 저희 팀 분위기 정말 좋아요. 궁금한 거 있으면 편하게 물어보세요!"
    menu:
        "팀의 기술 스택이나 코드 리뷰 문화에 대해 궁금합니다!":
            $pro += 1
            tea "오, 역시 개발자시네요! 저희는 주로..."
            jump q5_common_after_tea
        "팀의 전반적인 업무 분위기나, 팀원들끼리 얼마나 자주 소통하는지가 궁금해요!":
            $trust += 1
            tea "분위기요? 정말 자유롭고 수평적이에요! 슬랙으로 농담도 많이 하고..."
            jump q5_common_after_tea
        "혹시... 야근은 자주 하시나요? 그리고 휴가는 자유롭게 쓸 수 있나요?":
            $trust -= 2
            tea "어... 하하. 그건... 어느 회사나 비슷하지 않을까요?"
            jump q5_common_after_tea


# ──────────────────────────────────────────────────────────────────────────────
#
#                      5차 질문 및 히든 이벤트 후 복귀 지점
#
# ──────────────────────────────────────────────────────────────────────────────

label q5_common_after_tech:
    hide sen_neutral
    show iv_happy
    iv "네, 심층적인 답변 감사합니다. 다시 면접을 이어가겠습니다."
    jump q5_common

label q5_common_after_tea:
    hide tea_happy
    scene bg office
    show iv_neutral
    iv "네, 편안한 대화가 되셨나요? 그럼 마지막 질문으로 넘어가겠습니다."
    jump q7_final_question

label q5_common:
    show iv_thinking
    iv "네, 답변 잘 들었습니다. 지금까지는 과거의 경험과 상황 대처 능력에 대해 여쭤봤습니다."
    iv "이제 미래에 대한 질문을 드리고 싶군요."
    iv "만약 최종 합격하신다면, 입사 후 1년 뒤에 어떤 모습으로 성장해 있고 싶으신가요? 구체적인 목표를 말씀해주세요."
    menu:
        "1년 뒤에는 저희 팀의 핵심 도메인에 대해 가장 잘 아는 '도메인 전문가'가 되어, 신입 사원에게 기술과 업무를 알려줄 수 있는 사람이 되고 싶습니다.":
            $pro += 2
            $trust += 1
            jump q6_case_study
        "1년 안에 회사에 의미있는 수익을 창출하는 프로젝트를 하나 이상 성공시키고 싶습니다. 제 이름으로 된 성공 사례를 만드는 것이 목표입니다.":
            $pro += 2
            $creative += 1
            jump q6_case_study
        "다양한 부서의 사람들과 교류하며 회사 전체의 비즈니스 흐름을 이해하는 '제너럴리스트'가 되고 싶습니다. 기술 너머의 것을 보고 싶습니다.":
            $trust += 2
            $creative += 1
            jump q6_case_study

# ──────────────────────────────────────────────────
# 　　　　　　　 6차 질문 (케이스 스터디)
# ──────────────────────────────────────────────────

label q6_case_study:
    show iv_neutral
    iv "포부가 좋네요. 그럼 마지막으로, 실제 업무와 유사한 과제를 하나 드리겠습니다."
    iv "최근 10대들 사이에서 인기가 급상승 중인 새로운 소셜 미디어 '알파'가 등장했습니다. 우리 회사는 이 시장에 진출하기 위해 3개월 안에 경쟁 앱을 출시하라는 임무를 받았습니다. 당신이 이 프로젝트의 PM이라면, 어떻게 팀을 이끌고 프로젝트를 진행하시겠습니까?"
    menu:
        "1. 시장 분석 및 전략 수립: '알파'의 성공 요인과 약점을 철저히 분석하고, 우리는 '핵심 기능'에만 집중한 MVP 버전으로 빠르게 출시하여 시장 반응을 보겠습니다.":
            $pro += 2
            $creative += 1
            iv "전형적인 린 스타트업 방식이군요. 안정적이죠."
            jump q7_final_question
        "2. 팀 구성 및 기술 선정: 최고의 인재들로 소수 정예 팀을 꾸리고, 개발 속도가 가장 빠른 최신 기술 스택을 도입하여 3개월의 데드라인을 맞추는 데 집중하겠습니다.":
            $pro += 2
            $trust -= 1
            iv "기술과 인력 중심의 접근이군요. 팀원들이 번아웃 될 수도 있겠네요."
            jump q7_final_question
        "3. 창의적인 기능 기획: 경쟁 앱을 따라하기보다는, 10대들을 직접 인터뷰하여 그들이 정말 원하는 '완전히 새로운 기능'을 찾아내어 승부하겠습니다. 이것이 성공하면 시장을 지배할 수 있습니다.":
            $creative += 3
            $pro -= 1
            iv "하이 리스크, 하이 리턴 전략이군요. 흥미롭습니다."
            jump q7_final_question
        "4. 팀워크 및 비전 공유: 먼저 팀원들에게 이 프로젝트의 중요성과 비전을 설명하여 동기를 부여하고, 애자일 방법론을 도입하여 짧은 주기로 소통하며 함께 만들어가겠습니다.":
            $trust += 3
            $creative += 1
            iv "사람을 중요하게 생각하는군요. 팀의 잠재력을 최대로 끌어낼 수 있겠어요."
            jump q7_final_question


# ──────────────────────────────────────────────────
# 　　　　　　　 7차 최종 질문
# ──────────────────────────────────────────────────
label q7_final_question:
    show iv_neutral
    iv "네, 잘 들었습니다. 제가 드릴 질문은 여기까지입니다."
    iv "면접은 저희만 당신을 평가하는 자리가 아니라, 당신도 저희 회사를 평가하는 자리라고 생각합니다."
    iv "마지막으로 저희에게 하고 싶은 질문이 있다면 편하게 해주시길 바랍니다."

    menu:
        "제가 입사하게 된다면, 구체적으로 어떤 팀에 속하게 되며, 팀의 단기적인 목표와 장기적인 비전은 무엇인가요?":
            $pro += 2
            $trust += 1
            jump ending
        "회사의 성과 평가 및 보상 시스템은 어떻게 이루어져 있나요? 성과에 대한 공정한 평가와 보상을 중요하게 생각합니다.":
            $pro += 1
            jump ending
        "저는 함께 일하는 동료들을 통해 배우고 성장하는 것을 중요하게 생각합니다. 팀의 코드 리뷰 문화나 지식 공유 세션이 활성화되어 있는지 궁금합니다.":
            $trust += 2
            $pro += 1
            jump ending
        "회사의 성장 가능성을 믿고 지원했기 때문에, 특별한 질문은 없습니다. 기회를 주신다면 최선을 다해 기여하고 싶습니다.":
            $trust += 1
            jump ending
        "(웃으며) 면접관님은 왜 이 회사에 입사하셨고, 지금까지 만족하며 다니고 계신지 궁금합니다.":
            $creative += 1
            $trust += 1
            iv "하하, 이거 역면접인가요? 좋은 질문이네요."
            jump ending


# ──────────────────────────────────────────────────────────────────────────────
#
#                                  최종 평가 및 엔딩
#
# ──────────────────────────────────────────────────────────────────────────────

label ending:
    show iv_neutral
    iv "면접에 참여해주셔서 감사합니다. 긴 시간 고생 많으셨습니다."
    iv "..."
    iv "잠시 검토 후에 최종 결과를 말씀드리겠습니다."
    narr "면접관이 서류를 다시 한번 훑어본다. 짧은 시간이 영원처럼 느껴진다."
    iv "..."

    # ── S+ 등급 엔딩 ──────────────────────────────────
    if pro >= 10 and trust >= 8 and creative >= 8:
        show iv_happy
        iv "솔직히 말씀드리면, 오늘 본 지원자분들 중에 가장 탐나는 인재입니다."
        iv "전문성, 인성, 창의성... 뭐 하나 빠지는 것이 없네요. 당신 같은 사람을 놓치면 평생 후회할 것 같습니다."
        iv "저희가 드릴 수 있는 최고의 대우와 직책을 약속드리겠습니다. 내일부터 함께할 수 있을까요?"
        narr "S+ 등급: 전설의 탄생 엔딩"
        jump final_return

    # ── S 등급 엔딩 ───────────────────────────────────
    if pro >= 9 and trust >= 5 and creative >= 5:
        show iv_happy
        iv "정말 인상적인 분이시네요. 특히 보여주신 기술적 깊이와 문제 해결 능력은 저희 팀에 반드시 필요합니다."
        iv "꼭 함께 일하고 싶습니다. 긍정적으로 검토하여 최고의 조건으로 다시 연락드리겠습니다."
        narr "S 등급: 기술 스페셜리스트 엔딩"
        jump final_return

    if trust >= 9 and pro >= 5 and creative >= 5:
        show iv_happy
        iv "면접을 보는 내내 편안하고 즐거웠습니다. 당신의 긍정적인 에너지와 소통 능력이 팀에 엄청난 시너지를 가져다줄 것이라 확신합니다."
        iv "합격입니다. 두 팔 벌려 환영합니다!"
        narr "S 등급: 만장일치 합격 엔딩"
        jump final_return

    if creative >= 9 and pro >= 5 and trust >= 5:
        show iv_happy
        iv "당신처럼 새롭고 과감한 아이디어를 가진 인재를 기다려왔습니다."
        iv "우리 회사에 혁신을 가져다줄 분이라고 생각합니다. 저희와 함께 미래를 만들어가지 않으시겠습니까?"
        narr "S 등급: 혁신가 엔딩"
        jump final_return

    # ── A 등급 엔딩 ───────────────────────────────────
    if pro >= 7 and trust >= 4:
        show iv_happy
        iv "축하합니다! 합격입니다. 당신의 전문성과 안정감이 우리 팀에 큰 힘이 될 겁니다."
        iv "출근일은 추후 인사팀을 통해 공식적으로 연락드리겠습니다."
        narr "A 등급: 전문직 합격 엔딩"
        jump final_return

    if trust >= 7 and creative >= 4:
        show iv_happy
        iv "합격입니다! 함께 일하게 되어 기쁘네요."
        iv "당신의 긍정적인 에너지와 창의적인 아이디어가 우리 팀에 새로운 활력을 불어넣을 것 같습니다."
        narr "A 등급: 아이디어뱅크 합격 엔딩"
        jump final_return

    # ── B 등급 엔딩 ───────────────────────────────────
    if pro >= 6 or trust >= 6 or creative >= 6:
        show iv_neutral
        iv "내부적으로 논의가 조금 더 필요할 것 같습니다. 다른 지원자들과 함께 종합적으로 검토한 후, 일주일 내로 결과를 메일로 알려드리겠습니다."
        narr "B 등급: 합격권 보류 엔딩"
        jump final_return

    # ── C 등급 엔딩 ───────────────────────────────────
    if pro <= 2 and trust <= 2 and creative <= 2 and stress >= 5:
        show iv_serious
        iv "많이 긴장하신 탓인지, 본인의 역량을 제대로 보여주지 못하신 것 같아 아쉽습니다."
        iv "죄송하지만, 이번에는 인연이 닿지 않은 것 같네요."
        narr "F 등급: 역량 부족 탈락 엔딩"
        jump final_return

    if pro >= 5 and trust <= 1:
        show iv_thinking
        iv "기술적으로는 매우 뛰어나시지만, 저희가 중요하게 생각하는 팀워크와는 조금 맞지 않는 부분이 있는 것 같습니다."
        iv "결과는 신중하게 검토 후 알려드리겠습니다."
        narr "C 등급: 독불장군 엔딩"
        jump final_return

    if trust >= 5 and pro <= 1:
        show iv_thinking
        iv "사람은 정말 좋으신 것 같지만, 아쉽게도 저희가 필요로 하는 직무 역량에는 조금 미치지 못하는 것 같습니다."
        iv "결과는 메일로 알려드리겠습니다."
        narr "C 등급: 좋은 사람 엔딩"
        jump final_return

    if creative >= 5 and pro <= 1:
        show iv_thinking
        iv "매우 독창적이고 흥미로운 분이시네요. 다만, 아이디어를 현실로 구현해낼 구체적인 실행력이 부족해 보입니다."
        iv "결과는 메일로 알려드리겠습니다."
        narr "C 등급: 몽상가 엔딩"
        jump final_return


    # ── F 등급 엔딩 (기본) ─────────────────────────────
    show iv_serious
    iv "죄송하지만, 이번 채용에서는 아쉽게도 인연이 닿지 않은 것 같습니다."
    iv "더 좋은 곳에서 역량을 펼치시기를 응원하겠습니다."
    narr "F 등급: 탈락 엔딩"


label final_return:
    return
